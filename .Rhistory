}
# Anzahl der Zeilen
n <- nrow(df1)
# Vektor zur Speicherung der Korrelationswerte
correlations <- numeric(n)
# Schleife über alle Zeilen
for (i in 1:n) {
v1 <- as.numeric(df1[i, 1:25])
v2 <- as.numeric(df2[i, 1:25])
# Korrelation nur berechnen, wenn beide Vektoren Varianz haben
if (sd(v1, na.rm = TRUE) != 0 && sd(v2, na.rm = TRUE) != 0) {
correlations[i] <- cor(v1, v2, method = methode, use = "complete.obs")
} else {
correlations[i] <- NA
}
}
abs_correlations = abs(correlations)
mean_abs_correlation = mean(abs_correlations, na.rm = TRUE)
return(list(
correlations = correlations, mean_abs_correlation = mean_abs_correlation
))
}
# Mittelwert der Korrelationswerte (ctrl vs. rnase) von denjenigen Proteinen, deren Hauptmaximum um mindestens 2 Fraktionen verschoben ist
testing_cor_shifter = correlations(ctrl_main_shift, rnase_main_shift)
testing_cor_shifter$mean_abs_correlation
# Mittelwert der Korrelationswerte (ctrl vs. rnase) von denjenigen Proteinen, deren Hauptmaximum nicht um mindestens 2 Fraktionen verschoben ist
testing_cor_no_shifter = correlations(ctrl_no_main_shift, rnase_no_main_shift)
testing_cor_no_shifter$mean_abs_correlation
# Hat sich die Hypothese bewahrheitet, ist der Mittelwert der Korrelationen der shifter kleiner als die der no_shifter?
testing_cor_shifter$mean_abs_correlation < testing_cor_no_shifter$mean_abs_correlation
cor_all_proteins = correlations(ctrl_norm_mean, rnase_norm_mean)
cor_all_proteins$mean_abs_correlation
#Vektoren der Maxima-Anzahl extrahieren
n_max_ctrl  <- ctrl_no_main_shift$n_max_comb
n_max_rnase <- rnase_no_main_shift$n_max_comb
#Proteine (Zeilennamen) mit gleicher Maxima-Anzahl finden
unequal_max_proteins <- rownames(ctrl_no_main_shift)[n_max_ctrl != n_max_rnase]
#Neuen DataFrame ctrl_equal_max mit diesen Proteinen erstellen
ctrl_unequal_max <- ctrl_no_main_shift[unequal_max_proteins, ]
rnase_unequal_max <- rnase_no_main_shift[unequal_max_proteins, ]
#Vor Abgabe löschen
#dim(ctrl_unequal_max)
#dim(rnase_unequal_max)
#Vektoren der Maxima-Anzahl extrahieren
n_max_ctrl  <- ctrl_no_main_shift$n_max_comb
n_max_rnase <- rnase_no_main_shift$n_max_comb
#Proteine (Zeilennamen) mit gleicher Maxima-Anzahl finden
equal_max_proteins <- rownames(ctrl_no_main_shift)[n_max_ctrl == n_max_rnase]
#Neuen DataFrame ctrl_equal_max mit diesen Proteinen erstellen
ctrl_equal_max <- ctrl_no_main_shift[equal_max_proteins, ]
rnase_equal_max <- rnase_no_main_shift[equal_max_proteins, ]
#Test: Löschen vor Abgabe
#dim(ctrl_no_main_shift)
#dim(rnase_equal_max)
#dim(ctrl_main_shift)
#length(n_max_ctrl)
#length(n_max_rnase)
ctrl_selected = rbind(ctrl_main_shift, ctrl_unequal_max)
rnase_selected = rbind(rnase_main_shift, rnase_unequal_max)
sum(rownames(ctrl_selected) != rownames(rnase_selected))
ctrl_not_selected = ctrl_equal_max
rnase_not_selected = rnase_equal_max
dim(ctrl_not_selected)[1] + dim(ctrl_selected)[1] == 4765
# Mittelwerte pro Zeile berechnen und Differenz bilden
get_differences <- function(ctrl_df, rnase_df, ctrl_col, rnase_col) {
ctrl_means <- sapply(ctrl_df[[ctrl_col]], mean)
rnase_means <- sapply(rnase_df[[rnase_col]], mean)
return(ctrl_means - rnase_means)
}
# Berechne die Differenzvektoren für beide Gruppen
diff_selected <- get_differences(ctrl_selected, rnase_selected, "combined_max_ctrl", "combined_max_rnase")
diff_not_selected <- get_differences(ctrl_not_selected, rnase_not_selected, "combined_max_ctrl", "combined_max_rnase")
# Wilcoxon Rank-Sum Test (ungepaart)
wilcox_test_result <- wilcox.test(diff_selected, diff_not_selected)
# Ergebnis anzeigen
print(wilcox_test_result)
#View(ctrl_selected)
#View(rnase_selected)
#View(ctrl_not_selected)
#View(rnase_not_selected)
# Nur numerische Spalten behalten
pca_ctrl_numeric <- ctrl_selected[1:25, sapply(ctrl_selected, is.numeric)]
pca_rnase_numeric <- rnase_selected[1:25, sapply(rnase_selected, is.numeric)]
# Zeilen mit NAs entfernen
pca_ctrl_clean <- pca_ctrl_numeric[complete.cases(pca_ctrl_numeric), ]
pca_rnase_clean <- pca_rnase_numeric[complete.cases(pca_rnase_numeric), ]
pca_result_ctrl <- prcomp(pca_ctrl_clean, center = TRUE, scale. = TRUE, )
pca_result_rnase <- prcomp(pca_rnase_clean, center = TRUE, scale. = TRUE)
# Nur numerische Spalten behalten
pca_ctrl_numeric_not_selected <- ctrl_not_selected[1:25, sapply(ctrl_not_selected, is.numeric)]
pca_rnase_numeric_not_selected <- rnase_not_selected[1:25, sapply(rnase_not_selected, is.numeric)]
# Zeilen mit NAs entfernen
pca_ctrl_clean_not_selected <- pca_ctrl_numeric_not_selected[complete.cases(pca_ctrl_numeric_not_selected), ]
pca_rnase_clean_not_selected <- pca_rnase_numeric_not_selected[complete.cases(pca_rnase_numeric_not_selected), ]
pca_result_ctrl_not_selected <- prcomp(pca_ctrl_clean_not_selected, center = TRUE, scale. = TRUE, )
pca_result_rnase_not_selected <- prcomp(pca_rnase_clean_not_selected, center = TRUE, scale. = TRUE)
#chech which PCs have the most variance
summary(pca_result_ctrl)
summary(pca_result_rnase)
#plot PC1 with PC2
plot(pca_result_ctrl$x[,1:2], col = "blue", pch = 16,
xlab = "PC1", ylab = "PC2", main = "PCA: PC1 vs PC2 CTRL (SHIFT)")
plot(pca_result_rnase$x[,1:2], col = "blue", pch = 16,
xlab = "PC1", ylab = "PC2", main = "PCA: PC1 vs PC2 RNASE (SHIFT)")
#plot PC1 with PC3
plot(pca_result_ctrl$x[,c(1, 3)], col = "blue", pch = 16,
xlab = "PC1", ylab = "PC3", main = "PCA: PC1 vs PC3 CTRL (SHIFT)")
plot(pca_result_rnase$x[,c(1, 3)], col = "blue", pch = 16,
xlab = "PC1", ylab = "PC3", main = "PCA: PC1 vs PC3 RNASE (SHIFT)")
#plot PC2 with PC3
plot(pca_result_ctrl$x[,2:3], col = "blue", pch = 16,
xlab = "PC2", ylab = "PC3", main = "PCA: PC2 vs PC3 CTRL (SHIFT)")
plot(pca_result_rnase$x[,2:3], col = "blue", pch = 16,
xlab = "PC2", ylab = "PC3", main = "PCA: PC2 vs PC3 RNASE (SHIFT)")
# Einfaches 2D PCA-Plot
plot(pca_result_ctrl_not_selected$x[,1:2], col = "blue", pch = 16,
xlab = "PC1", ylab = "PC2", main = "PCA: PC1 vs PC2 CTRL (NO SHIFT)")
plot(pca_result_rnase_not_selected$x[,1:2], col = "blue", pch = 16,
xlab = "PC1", ylab = "PC2", main = "PCA: PC1 vs PC2 RNASE (NO SHIFT)")
#plot PC1 with PC3
plot(pca_result_ctrl_not_selected$x[,c(1, 3)], col = "blue", pch = 16,
xlab = "PC1", ylab = "PC3", main = "PCA: PC1 vs PC3 CTRL (NO SHIFT)")
plot(pca_result_rnase_not_selected$x[,c(1, 3)], col = "blue", pch = 16,
xlab = "PC1", ylab = "PC3", main = "PCA: PC1 vs PC3 RNASE (NO SHIFT)")
#plot PC2 with PC3
plot(pca_result_ctrl_not_selected$x[,2:3], col = "blue", pch = 16,
xlab = "PC2", ylab = "PC3", main = "PCA: PC2 vs PC3 CTRL (NO SHIFT)")
plot(pca_result_rnase_not_selected$x[,2:3], col = "blue", pch = 16,
xlab = "PC2", ylab = "PC3", main = "PCA: PC2 vs PC3 RNASE (NO SHIFT)")
#Centren für kmeans clustering erkennen
#--> 3 Centren
plot(pca_result_ctrl, type = "l", main = "Elbow-Plot CTRL (SHIFT)")
plot(pca_result_rnase, type = "l", main = "Elbow-Plot RNASE (SHIFT)")
#Centren für kmeans clustering erkennen
#--> 2 Centren
plot(pca_result_ctrl_not_selected, type = "l", main = "Elbow-Plot CTRL (NO SHIFT)")
plot(pca_result_rnase_not_selected, type = "l", main = "Elbow-Plot RNASE (NO SHIFT)")
pca_ctrl_pc1_pc2 <- as.data.frame(pca_result_ctrl$x[, 1:2])
pca_ctrl_pc1_pc3 <- as.data.frame(pca_result_ctrl$x[, c(1,3)])
pca_ctrl_pc2_pc3 <- as.data.frame(pca_result_ctrl$x[, 2:3])
pca_rnase_pc1_pc2 <- as.data.frame(pca_result_rnase$x[, 1:2])
pca_rnase_pc1_pc3 <- as.data.frame(pca_result_rnase$x[, c(1,3)])
pca_rnase_pc2_pc3 <- as.data.frame(pca_result_rnase$x[, 2:3])
pca_ctrl_pc1_pc2_not_selected <- as.data.frame(pca_result_ctrl_not_selected$x[, 1:2])
pca_ctrl_pc1_pc3_not_selected <- as.data.frame(pca_result_ctrl_not_selected$x[, c(1,3)])
pca_ctrl_pc2_pc3_not_selected <- as.data.frame(pca_result_ctrl_not_selected$x[, 2:3])
pca_rnase_pc1_pc2_not_selected <- as.data.frame(pca_result_rnase_not_selected$x[, 1:2])
pca_rnase_pc1_pc3_not_selected <- as.data.frame(pca_result_rnase_not_selected$x[, c(1,3)])
pca_rnase_pc2_pc3_not_selected <- as.data.frame(pca_result_rnase_not_selected$x[, 2:3])
#kmeans wird mit 3 Centren durchgeführt
km_result_ctrl_pc1_pc2<- kmeans(pca_ctrl_pc1_pc2, centers = 3)
km_result_ctrl_pc1_pc3<- kmeans(pca_ctrl_pc1_pc3, centers = 3)
km_result_ctrl_pc2_pc3<- kmeans(pca_ctrl_pc2_pc3, centers = 3)
km_result_rnase_pc1_pc2<- kmeans(pca_rnase_pc1_pc2, centers = 3)
km_result_rnase_pc1_pc3<- kmeans(pca_rnase_pc1_pc3, centers = 3)
km_result_rnase_pc2_pc3<- kmeans(pca_rnase_pc2_pc3, centers = 3)
#kmeans wird mit 3 Centren durchgeführt
km_result_ctrl_pc1_pc2_not_selected<- kmeans(pca_ctrl_pc1_pc2_not_selected, centers = 2)
km_result_ctrl_pc1_pc3_not_selected<- kmeans(pca_ctrl_pc1_pc3_not_selected, centers = 2)
km_result_ctrl_pc2_pc3_not_selected<- kmeans(pca_ctrl_pc2_pc3_not_selected, centers = 2)
km_result_rnase_pc1_pc2_not_selected<- kmeans(pca_rnase_pc1_pc2_not_selected, centers = 2)
km_result_rnase_pc1_pc3_not_selected<- kmeans(pca_rnase_pc1_pc3_not_selected, centers = 2)
km_result_rnase_pc2_pc3_not_selected<- kmeans(pca_rnase_pc2_pc3_not_selected, centers = 2)
library(factoextra)
# pca_df enthält deine Daten, z. B. PC1 und PC2
fviz_cluster(km_result_ctrl_pc1_pc2, data = pca_ctrl_pc1_pc2,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der CTRL (SHIFT)")
fviz_cluster(km_result_ctrl_pc1_pc3, data = pca_ctrl_pc1_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der CTRL (SHIFT)")
fviz_cluster(km_result_ctrl_pc2_pc3, data = pca_ctrl_pc2_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der CTRL (SHIFT)")
fviz_cluster(km_result_rnase_pc1_pc2, data = pca_rnase_pc1_pc2,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der RNASE (SHIFT)")
fviz_cluster(km_result_rnase_pc1_pc3, data = pca_rnase_pc1_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der RNASE (SHIFT)")
fviz_cluster(km_result_rnase_pc2_pc3, data = pca_rnase_pc2_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der RNASE (SHIFT)")
# pca_df enthält deine Daten, z. B. PC1 und PC2
fviz_cluster(km_result_ctrl_pc1_pc2_not_selected, data = pca_ctrl_pc1_pc2,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der CTRL (NO SHIFT)")
fviz_cluster(km_result_ctrl_pc1_pc3_not_selected, data = pca_ctrl_pc1_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der CTRL (NO SHIFT)")
fviz_cluster(km_result_ctrl_pc2_pc3_not_selected, data = pca_ctrl_pc2_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der CTRL (NO SHIFT)")
fviz_cluster(km_result_rnase_pc1_pc2_not_selected, data = pca_rnase_pc1_pc2,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der RNASE (NO SHIFT)")
fviz_cluster(km_result_rnase_pc1_pc3_not_selected, data = pca_rnase_pc1_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der RNASE (NO SHIFT)")
fviz_cluster(km_result_rnase_pc2_pc3_not_selected, data = pca_rnase_pc2_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der RNASE (NO SHIFT)")
# 1. Zwei PCA-Datensätze: z. B. mit PC1 und PC2
# Achte darauf, dass beide den gleichen Spaltennamen und Anzahl Spalten haben!
pca_ctrl_subset <- pca_rnase_pc2_pc3[, c( "PC2", "PC3")]
pca_rnase_subset <- pca_rnase_pc2_pc3_not_selected [, c( "PC2", "PC3")]
# 2. Kombiniere sie zu einem DataFrame
pca_combined <- rbind(pca_ctrl_subset, pca_rnase_subset)
# 3. Erzeuge den Gruppenfaktor
group <- factor(c(rep("CTRL", nrow(pca_ctrl_subset)),
rep("RNASE", nrow(pca_rnase_subset))))
# 4. MANOVA durchführen
manova_result <- manova(cbind(PC2, PC3) ~ group, data = data.frame(PC2 = pca_combined$PC2,
PC3 = pca_combined$PC3,
group = group))
# 5. Zusammenfassung anzeigen
summary(manova_result)
#Für ctrl
#Generiert einen Plot mit den Datenpunkten der PCA und malt eine Trendlinie dadurch
plot(pca_ctrl_pc1_pc2$PC1,pca_ctrl_pc1_pc2$PC2,pch=20,col='blue', xlab='PC1',ylab='PC2');abline(0,1,col='red')
plot(pca_ctrl_pc1_pc3$PC1,pca_ctrl_pc1_pc3$PC3,pch=20,col='blue', xlab='PC1',ylab='PC3');abline(0,1,col='red')
plot(pca_ctrl_pc2_pc3$PC2,pca_ctrl_pc2_pc3$PC3,pch=20,col='blue', xlab='PC2',ylab='PC3');abline(0,1,col='red')
#Je eine PCA Komponente wird als Zielvariable definiert, also als das, was mit der Regressionsanalyse vorhergesagt werden soll
target_ctrl_pc1pc2 <- pca_ctrl_pc1_pc2$PC2
target_ctrl_pc1pc3 <- pca_ctrl_pc1_pc3$PC3
target_ctrl_pc2pc3 <- pca_ctrl_pc2_pc3$PC3
#Zusammengesetzten dataframe für Regressionsanalyse aus Zielvariable mit zwei PCA Komponenten aufbauen
df_regression_ctrl_1 <- cbind(target = target_ctrl_pc1pc2,
pca_ctrl_pc1_pc2)
df_regression_ctrl_2 <- cbind(target = target_ctrl_pc1pc3,
pca_ctrl_pc1_pc3)
df_regression_ctrl_3 <- cbind(target = target_ctrl_pc2pc3,
pca_ctrl_pc2_pc3)
#Multiple Lineare Regressionsanalyse
model_ctrl_pc1_pc2 <- lm(target ~ PC1 + PC2, data = df_regression_ctrl_1)
model_ctrl_pc1_pc3 <- lm(target ~ PC1 + PC3, data = df_regression_ctrl_2)
model_ctrl_pc2_pc3 <- lm(target ~ PC2 + PC3, data = df_regression_ctrl_3)
#Ergebnisse/Zusammenfassung anzeigen
summary(model_ctrl_pc1_pc2)
summary(model_ctrl_pc1_pc3)
summary(model_ctrl_pc2_pc3)
#Das gleiche für rnase
plot(pca_rnase_pc1_pc2$PC1,pca_rnase_pc1_pc2$PC2,pch=20,col='blue', xlab='PC1',ylab='PC2');abline(0,1,col='red')
plot(pca_rnase_pc1_pc3$PC1,pca_rnase_pc1_pc3$PC3,pch=20,col='blue', xlab='PC1',ylab='PC3');abline(0,1,col='red')
plot(pca_rnase_pc2_pc3$PC2,pca_rnase_pc2_pc3$PC3,pch=20,col='blue', xlab='PC2',ylab='PC3');abline(0,1,col='red')
target_rnase_pc1pc2 <- pca_rnase_pc1_pc2$PC2
target_rnase_pc1pc3 <- pca_rnase_pc1_pc3$PC3
target_rnase_pc2pc3 <- pca_rnase_pc2_pc3$PC3
df_regression_rnase_1 <- cbind(target = target_rnase_pc1pc2,
pca_rnase_pc1_pc2)
df_regression_rnase_2 <- cbind(target = target_rnase_pc1pc3,
pca_rnase_pc1_pc3)
df_regression_rnase_3 <- cbind(target = target_rnase_pc2pc3,
pca_rnase_pc2_pc3)
model_rnase_pc1_pc2 <- lm(target ~ PC1 + PC2, data = df_regression_rnase_1)
model_rnase_pc1_pc3 <- lm(target ~ PC1 + PC3, data = df_regression_rnase_2)
model_rnase_pc2_pc3 <- lm(target ~ PC2 + PC3, data = df_regression_rnase_3)
summary(model_rnase_pc1_pc2)
summary(model_rnase_pc1_pc3)
summary(model_rnase_pc2_pc3)
#Für ctrl
#Generiert einen Plot mit den Datenpunkten der PCA und malt eine Trendlinie dadurch
plot(pca_ctrl_pc1_pc2_not_selected$PC1,pca_ctrl_pc1_pc2_not_selected$PC2,pch=20,col='blue', xlab='PC1',ylab='PC2');abline(0,1,col='red')
plot(pca_ctrl_pc1_pc3_not_selected$PC1,pca_ctrl_pc1_pc3_not_selected$PC3,pch=20,col='blue', xlab='PC1',ylab='PC3');abline(0,1,col='red')
plot(pca_ctrl_pc2_pc3_not_selected$PC2,pca_ctrl_pc2_pc3_not_selected$PC3,pch=20,col='blue', xlab='PC2',ylab='PC3');abline(0,1,col='red')
#Je eine PCA Komponente wird als Zielvariable definiert, also als das, was mit der Regressionsanalyse vorhergesagt werden soll
target_ctrl_pc1pc2_not_selected <- pca_ctrl_pc1_pc2_not_selected$PC2
target_ctrl_pc1pc3_not_selected <- pca_ctrl_pc1_pc3_not_selected$PC3
target_ctrl_pc2pc3_not_selected <- pca_ctrl_pc2_pc3_not_selected$PC3
#Zusammengesetzten dataframe für Regressionsanalyse aus Zielvariable mit zwei PCA Komponenten aufbauen
df_regression_ctrl_1_not_selected <- cbind(target = target_ctrl_pc1pc2_not_selected,
pca_ctrl_pc1_pc2_not_selected)
df_regression_ctrl_2_not_selected <- cbind(target = target_ctrl_pc1pc3_not_selected,
pca_ctrl_pc1_pc3_not_selected)
df_regression_ctrl_3_not_selected <- cbind(target = target_ctrl_pc2pc3_not_selected,
pca_ctrl_pc2_pc3_not_selected)
#Multiple Lineare Regressionsanalyse
model_ctrl_pc1_pc2_not_selected <- lm(target ~ PC1 + PC2, data = df_regression_ctrl_1_not_selected)
model_ctrl_pc1_pc3_not_selected <- lm(target ~ PC1 + PC3, data = df_regression_ctrl_2_not_selected)
model_ctrl_pc2_pc3_not_selected <- lm(target ~ PC2 + PC3, data = df_regression_ctrl_3_not_selected)
#Ergebnisse/Zusammenfassung anzeigen
summary(model_ctrl_pc1_pc2_not_selected)
summary(model_ctrl_pc1_pc3_not_selected)
summary(model_ctrl_pc2_pc3_not_selected)
#Das gleiche für rnase
plot(pca_rnase_pc1_pc2_not_selected$PC1,pca_rnase_pc1_pc2_not_selected$PC2,pch=20,col='blue', xlab='PC1',ylab='PC2');abline(0,1,col='red')
plot(pca_rnase_pc1_pc3_not_selected$PC1,pca_rnase_pc1_pc3_not_selected$PC3,pch=20,col='blue', xlab='PC1',ylab='PC3');abline(0,1,col='red')
plot(pca_rnase_pc2_pc3_not_selected$PC2,pca_rnase_pc2_pc3_not_selected$PC3,pch=20,col='blue', xlab='PC2',ylab='PC3');abline(0,1,col='red')
target_rnase_pc1pc2_not_selected <- pca_rnase_pc1_pc2_not_selected$PC2
target_rnase_pc1pc3_not_selected <- pca_rnase_pc1_pc3_not_selected$PC3
target_rnase_pc2pc3_not_selected <- pca_rnase_pc2_pc3_not_selected$PC3
df_regression_rnase_1_not_selected <- cbind(target = target_rnase_pc1pc2_not_selected,
pca_rnase_pc1_pc2_not_selected)
df_regression_rnase_2_not_selected <- cbind(target = target_rnase_pc1pc3_not_selected,
pca_rnase_pc1_pc3_not_selected)
df_regression_rnase_3_not_selected <- cbind(target = target_rnase_pc2pc3_not_selected,
pca_rnase_pc2_pc3_not_selected)
model_rnase_pc1_pc2_not_selected <- lm(target ~ PC1 + PC2, data = df_regression_rnase_1_not_selected)
model_rnase_pc1_pc3_not_selected <- lm(target ~ PC1 + PC3, data = df_regression_rnase_2_not_selected)
model_rnase_pc2_pc3_not_selected <- lm(target ~ PC2 + PC3, data = df_regression_rnase_3_not_selected)
summary(model_rnase_pc1_pc2_not_selected)
summary(model_rnase_pc1_pc3_not_selected)
summary(model_rnase_pc2_pc3_not_selected)
library(factoextra)
# pca_df enthält deine Daten, z. B. PC1 und PC2
fviz_cluster(km_result_ctrl_pc1_pc2, data = pca_ctrl_pc1_pc2,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC1 vs PC2 CTRL (SHIFT)")
fviz_cluster(km_result_ctrl_pc1_pc3, data = pca_ctrl_pc1_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC1 vs PC3 CTRL (SHIFT)")
fviz_cluster(km_result_ctrl_pc2_pc3, data = pca_ctrl_pc2_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC2 vs PC3 CTRL (SHIFT)")
fviz_cluster(km_result_rnase_pc1_pc2, data = pca_rnase_pc1_pc2,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC1 vs PC2 RNASE (SHIFT)")
fviz_cluster(km_result_rnase_pc1_pc3, data = pca_rnase_pc1_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC1 vs PC3 RNASE (SHIFT)")
fviz_cluster(km_result_rnase_pc2_pc3, data = pca_rnase_pc2_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC2 vs PC3 RNASE (SHIFT)")
# pca_df enthält deine Daten, z. B. PC1 und PC2
fviz_cluster(km_result_ctrl_pc1_pc2_not_selected, data = pca_ctrl_pc1_pc2,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der CTRL (NO SHIFT)")
fviz_cluster(km_result_ctrl_pc1_pc3_not_selected, data = pca_ctrl_pc1_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der CTRL (NO SHIFT)")
fviz_cluster(km_result_ctrl_pc2_pc3_not_selected, data = pca_ctrl_pc2_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der CTRL (NO SHIFT)")
fviz_cluster(km_result_rnase_pc1_pc2_not_selected, data = pca_rnase_pc1_pc2,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC1 vs PC2 RNASE (NO SHIFT)")
fviz_cluster(km_result_rnase_pc1_pc3_not_selected, data = pca_rnase_pc1_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC1 vs PC3 RNASE (NO SHIFT)")
fviz_cluster(km_result_rnase_pc2_pc3_not_selected, data = pca_rnase_pc2_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC2 vs PC3 RNASE (NO SHIFT)")
library(factoextra)
# pca_df enthält deine Daten, z. B. PC1 und PC2
fviz_cluster(km_result_ctrl_pc1_pc2, data = pca_ctrl_pc1_pc2,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC1 vs PC2 CTRL (SHIFT)")
fviz_cluster(km_result_ctrl_pc1_pc3, data = pca_ctrl_pc1_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC1 vs PC3 CTRL (SHIFT)")
fviz_cluster(km_result_ctrl_pc2_pc3, data = pca_ctrl_pc2_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC2 vs PC3 CTRL (SHIFT)")
fviz_cluster(km_result_rnase_pc1_pc2, data = pca_rnase_pc1_pc2,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC1 vs PC2 RNASE (SHIFT)")
fviz_cluster(km_result_rnase_pc1_pc3, data = pca_rnase_pc1_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC1 vs PC3 RNASE (SHIFT)")
fviz_cluster(km_result_rnase_pc2_pc3, data = pca_rnase_pc2_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC2 vs PC3 RNASE (SHIFT)")
# pca_df enthält deine Daten, z. B. PC1 und PC2
fviz_cluster(km_result_ctrl_pc1_pc2_not_selected, data = pca_ctrl_pc1_pc2_not_selected,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der CTRL (NO SHIFT)")
fviz_cluster(km_result_ctrl_pc1_pc3_not_selected, data = pca_ctrl_pc1_pc3_not_selected,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der CTRL (NO SHIFT)")
fviz_cluster(km_result_ctrl_pc2_pc3_not_selected, data = pca_ctrl_pc2_pc3_not_selected,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der CTRL (NO SHIFT)")
fviz_cluster(km_result_rnase_pc1_pc2_not_selected, data = pca_rnase_pc1_pc2_not_selected,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC1 vs PC2 RNASE (NO SHIFT)")
fviz_cluster(km_result_rnase_pc1_pc3_not_selected, data = pca_rnase_pc1_pc3_not_selected,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC1 vs PC3 RNASE (NO SHIFT)")
fviz_cluster(km_result_rnase_pc2_pc3_not_selected, data = pca_rnase_pc2_pc3_not_selected,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC2 vs PC3 RNASE (NO SHIFT)")
# 1. Zwei PCA-Datensätze: z. B. mit PC1 und PC2
# Achte darauf, dass beide den gleichen Spaltennamen und Anzahl Spalten haben!
pca_ctrl_subset <- pca_rnase_pc2_pc3[, c( "PC2", "PC3")]
pca_rnase_subset <- pca_rnase_pc2_pc3_not_selected [, c( "PC2", "PC3")]
# 2. Kombiniere sie zu einem DataFrame
pca_combined <- rbind(pca_ctrl_subset, pca_rnase_subset)
# 3. Erzeuge den Gruppenfaktor
group <- factor(c(rep("CTRL", nrow(pca_ctrl_subset)),
rep("RNASE", nrow(pca_rnase_subset))))
# 4. MANOVA durchführen
manova_result <- manova(cbind(PC2, PC3) ~ group, data = data.frame(PC2 = pca_combined$PC2,
PC3 = pca_combined$PC3,
group = group))
# 5. Zusammenfassung anzeigen
summary(manova_result)
#plot PC1 with PC2
plot(pca_result_ctrl$x[,1:2], col = "blue", pch = 16,
xlab = "PC1", ylab = "PC2", main = "PCA: PC1 vs PC2 CTRL (SHIFT)")
# pca_df enthält deine Daten, z. B. PC1 und PC2
fviz_cluster(km_result_ctrl_pc1_pc2, data = pca_ctrl_pc1_pc2,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC1 vs PC2 CTRL (SHIFT)")
plot(pca_result_rnase$x[,1:2], col = "blue", pch = 16,
xlab = "PC1", ylab = "PC2", main = "PCA: PC1 vs PC2 RNASE (SHIFT)")
fviz_cluster(km_result_rnase_pc1_pc2, data = pca_rnase_pc1_pc2,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC1 vs PC2 RNASE (SHIFT)")
#plot PC1 with PC3
plot(pca_result_ctrl$x[,c(1, 3)], col = "blue", pch = 16,
xlab = "PC1", ylab = "PC3", main = "PCA: PC1 vs PC3 CTRL (SHIFT)")
fviz_cluster(km_result_ctrl_pc1_pc3, data = pca_ctrl_pc1_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC1 vs PC3 CTRL (SHIFT)")
plot(pca_result_rnase$x[,c(1, 3)], col = "blue", pch = 16,
xlab = "PC1", ylab = "PC3", main = "PCA: PC1 vs PC3 RNASE (SHIFT)")
fviz_cluster(km_result_rnase_pc1_pc3, data = pca_rnase_pc1_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC1 vs PC3 RNASE (SHIFT)")
#plot PC2 with PC3
plot(pca_result_ctrl$x[,2:3], col = "blue", pch = 16,
xlab = "PC2", ylab = "PC3", main = "PCA: PC2 vs PC3 CTRL (SHIFT)")
fviz_cluster(km_result_ctrl_pc2_pc3, data = pca_ctrl_pc2_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC2 vs PC3 CTRL (SHIFT)")
plot(pca_result_rnase$x[,2:3], col = "blue", pch = 16,
xlab = "PC2", ylab = "PC3", main = "PCA: PC2 vs PC3 RNASE (SHIFT)")
fviz_cluster(km_result_rnase_pc2_pc3, data = pca_rnase_pc2_pc3,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC2 vs PC3 RNASE (SHIFT)")
# Einfaches 2D PCA-Plot
plot(pca_result_ctrl_not_selected$x[,1:2], col = "blue", pch = 16,
xlab = "PC1", ylab = "PC2", main = "PCA: PC1 vs PC2 CTRL (NO SHIFT)")
# pca_df enthält deine Daten, z. B. PC1 und PC2
fviz_cluster(km_result_ctrl_pc1_pc2_not_selected, data = pca_ctrl_pc1_pc2_not_selected,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der CTRL (NO SHIFT)")
plot(pca_result_rnase_not_selected$x[,1:2], col = "blue", pch = 16,
xlab = "PC1", ylab = "PC2", main = "PCA: PC1 vs PC2 RNASE (NO SHIFT)")
fviz_cluster(km_result_rnase_pc1_pc2_not_selected, data = pca_rnase_pc1_pc2_not_selected,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC1 vs PC2 RNASE (NO SHIFT)")
#plot PC1 with PC3
plot(pca_result_ctrl_not_selected$x[,c(1, 3)], col = "blue", pch = 16,
xlab = "PC1", ylab = "PC3", main = "PCA: PC1 vs PC3 CTRL (NO SHIFT)")
fviz_cluster(km_result_ctrl_pc1_pc3_not_selected, data = pca_ctrl_pc1_pc3_not_selected,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der CTRL (NO SHIFT)")
plot(pca_result_rnase_not_selected$x[,c(1, 3)], col = "blue", pch = 16,
xlab = "PC1", ylab = "PC3", main = "PCA: PC1 vs PC3 RNASE (NO SHIFT)")
fviz_cluster(km_result_rnase_pc1_pc3_not_selected, data = pca_rnase_pc1_pc3_not_selected,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC1 vs PC3 RNASE (NO SHIFT)")
#plot PC2 with PC3
plot(pca_result_ctrl_not_selected$x[,2:3], col = "blue", pch = 16,
xlab = "PC2", ylab = "PC3", main = "PCA: PC2 vs PC3 CTRL (NO SHIFT)")
fviz_cluster(km_result_ctrl_pc2_pc3_not_selected, data = pca_ctrl_pc2_pc3_not_selected,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster der CTRL (NO SHIFT)")
plot(pca_result_rnase_not_selected$x[,2:3], col = "blue", pch = 16,
xlab = "PC2", ylab = "PC3", main = "PCA: PC2 vs PC3 RNASE (NO SHIFT)")
fviz_cluster(km_result_rnase_pc2_pc3_not_selected, data = pca_rnase_pc2_pc3_not_selected,
geom = "point", ellipse.type = "norm",
palette = "jco", ggtheme = theme_minimal(),
main = "k-Means Cluster: PC2 vs PC3 RNASE (NO SHIFT)")
